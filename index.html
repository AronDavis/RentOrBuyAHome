<html>
	<head>
		<script src="js/jquery-3.1.0.min.js"></script>
	</head>
	<body>
        <script>
        $(function(){
            console.log("working");
        });
        </script>
	</body>
</html>


<script>
    var originalPrincipal = 320000;
    var loanTermInYears = 30;
    var annualInterestRate = .03;
    var paymentsPerYear = 12;
    var extraPayment = 0;

    var rentPayment = 335;

    function getInterestForPayment(currentBalance)
    {
        return (annualInterestRate / paymentsPerYear) * currentBalance;
    }

    function getPrincipalForPayment(currentBalance, payment)
    {
        return payment - getInterestForPayment(currentBalance);
    }

    function getMonthlyPayment(startingPrincipal)
    {
        var interestRatePerPayment = annualInterestRate / paymentsPerYear;
        var numberOfPayments = paymentsPerYear * loanTermInYears;

        return startingPrincipal *
            ( 
                interestRatePerPayment
                * Math.pow(1 + interestRatePerPayment, numberOfPayments)
            )
        /
        (
            Math.pow(1 + interestRatePerPayment, numberOfPayments) - 1
        );
        //P = B[(r/12)(1 + r/12)^m)]/[(1 + r/12)^m - 1]
    }

    function round(value, decimals)
    {
        return Number(Math.round(value + 'e' + decimals) + 'e-' + decimals);
    }

    function add(a, b)
    {
        return a + b;
    }


    function getTotalInterest(startingPrincipal)
    {
        var payment = getMonthlyPayment(startingPrincipal);

        var numPayments = paymentsPerYear * loanTermInYears;
        var balances = [startingPrincipal];
        var paymentsPrincipal = [null];
        var paymentsInterest = [null];
        for (var i = 1; i <= numPayments; i++)
        {
            var prevBalance = balances[i - 1];
            var paymentPrincipal = getPrincipalForPayment(prevBalance, payment);
            var paymentInterest = getInterestForPayment(prevBalance);

            paymentsPrincipal[i] = paymentPrincipal;
            paymentsInterest[i] = paymentInterest;
            balances[i] = prevBalance - paymentPrincipal;

            if (balances[i] <= 0)
            {
                balances[i] = 0;
                break;
            }
        }

        var totalPrincipal = paymentsPrincipal.reduce(add);
        var totalInterest = paymentsInterest.reduce(add);
        var payoff = balances.length - 1;

        return totalInterest;
    }


    var amountSavedPerDollarInDownPayment = getTotalInterest(1);
    var valueOfDollarInDownPayment = amountSavedPerDollarInDownPayment + 1;

    var trueCostOfRent = rentPayment * valueOfDollarInDownPayment;

    //if I put rent into down payment, this is how much money it would save me in interest
    var interestSavingsByPuttingRentTowardsHouse = trueCostOfRent - rentPayment;

    /*
    var interestChanges = [getTotalInterest(originalPrincipal)];
    
    for(var i = 1; i <= 12; i++)
    {
        var rentNotAppliedToPrincipal = rentPayment * i;

        interestChanges[i] = getTotalInterest(originalPrincipal - rentNotAppliedToPrincipal);
    }

    console.log(interestChanges);

    var diff = [];

    for(var i = 0; i < 12; i++)
    {
        //how much I'm losing by paying for rent
        diff[i] = (interestChanges[i] - interestChanges[i + 1]) - rentPayment;
    }

    console.log(diff);
    */


    var mustSavePerDollarOfRent = valueOfDollarInDownPayment / amountSavedPerDollarInDownPayment;

    var mustSave = rentPayment * mustSavePerDollarOfRent;

    console.log(amountSavedPerDollarInDownPayment);
    console.log(valueOfDollarInDownPayment);
    console.log(mustSavePerDollarOfRent);

    var totalCostPayingRentAndSaving = getTotalInterest(originalPrincipal - mustSave) + rentPayment;
    var totalCostPuttingRentIntoDownPayment = getTotalInterest(originalPrincipal - rentPayment);

    console.log(Math.round(totalCostPayingRentAndSaving - totalCostPuttingRentIntoDownPayment));
    console.log(mustSave);
    var costPayingRentAndSaving = getTotalInterest(originalPrincipal - mustSave) + rentPayment;
    var costPuttingRentIntoDownPayment = getTotalInterest(originalPrincipal - rentPayment);
    
</script>